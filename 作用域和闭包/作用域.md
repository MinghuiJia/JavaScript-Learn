<!--
 * @Author: jiaminghui
 * @Date: 2022-12-03 16:05:08
 * @LastEditTime: 2022-12-03 22:40:53
 * @LastEditors: jiaminghui
 * @FilePath: \JavaScript_Learn\作用域和闭包\作用域.md
 * @Description: 
-->
## JavaScript的作用域
作用域：一套设计良好的规则来存储变量，并且之后可以方便地找到这些变量

### 编译原理
1.  传统编译语言的流程：
    - 分词/词法分析 ——词法单元
    - 解析/语法分析 ——抽象语法树
    - 代码生成 ——转化为机器语言
2.  JavaScript虽然被归类为“动态”或“解释执行”语言，但事实上它是一门编译语言
    - 与传统的编译语言不同，它不是提前编译的（编译发生在**代码执行的前几微妙**甚至更短）
    - 编译结果也不能在分布式系统中进行移植
    - JavaScript在**语法分析**和**代码生成**阶段，有特殊的步骤来**对运行性能进行优化**（包括对**冗余元素**进行优化）

### 作用域
1.  作用域理解：负责收集并维护由所有声明的标识符（变量）组成的一系列查询，并实施一套非常严格的规则，确定当前执行的代码对这些标识符的访问权限
2.  作用域参与其中的变量赋值操作`var a = 2;`：
    - 首先编译器会在当前作用域中声明一个变量（如果之前没有声明过）
    - 然后在运行时引擎会在作用域中查找该变量，如果能够找到就会对它赋值
3.  引擎查找变量的方式：
    - `RHS`：当变量出现在赋值操作的非左侧进行`RHS`查询（谁是赋值操作的源头），试图找到变量的容器本身从而可以对其赋值
    - `LHS`：当变量出现在赋值操作的左侧时进行`LHS`查询（赋值操作的目标是谁），只是简单地查找某个变量的值
    注意：函数的声明`function foo(a) {...`并不能理解为声明和赋值操作的组合，因为引擎并不会有线程专门用于将函数值分配给变量
4.  作用域嵌套
    - 查找变量时，遍历嵌套作用域链
    - 遍历嵌套规则：从当前的执行作用域开始查找变量，如果找不到就向上一级继续查找。当抵达最外层的全局作用域时，无论找到还是没找到，查找过程都会停止
5.  异常：针对`RHS`与`LHS`查询方式的不同，查询的结果也不一样
    - `RHS`：如果在全局作用域中都未找到变量，引擎会抛出**ReferenceError**异常
    - `LHS`：如果在全局作用域中都未找到变量，**全局作用域**会**创建**一个具有该名称的变量并返回给引擎（前提是在**非严格模式**下）
    注意：严格模式下，禁止自动或隐式地创建全局变量。在严格模式下，`LHS`查询失败时也会抛出ReferenceError异常


